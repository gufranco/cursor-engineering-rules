---
description: Raise agent/auto mode quality via process and evidence
alwaysApply: true
---

# Agent / Auto Mode Quality

Complements `00-core.mdc` and `02-task-completion.mdc`. When running autonomously (Agent or Auto), follow a strict process so analysis, decisions, and outputs stay reliable even when a faster/lighter model is used.

## Response Template (Use This Structure)

Follow this order so outputs are predictable and complete:

1. **Goal** – One sentence: what must be true when done.
2. **Read/Verify** – What you will read or run (files, types, commands). **Include: search codebase** (grep/glob/semantic) and **PRs/branches** for an existing solution before implementing. Then do it.
3. **Plan** – 1–3 bullets: what you will do. If multi-step, name the steps and do one at a time.
4. **Do** – Make the change(s). Prefer minimal edits (see below).
5. **Verify** – Run the relevant command(s) and **paste the output** (last 10–20 lines is enough). Do not say "tests pass" without showing it.

Short, scannable lists beat long paragraphs. Use bullets and tables when summarizing.

## Before Acting

1. **State the goal** in one sentence (what must be true when done).
2. **List what must be read or verified** (files, APIs, types, env), **including a search for existing solution** (codebase + PRs/branches) — then **perform each** (read, grep, run) before proposing code.
3. **Propose the approach** in 1–3 bullets; if the task is multi-step, break it into steps and work one at a time.

Do not implement until the above is done. Prefer verification over speed.

## While Implementing

- **One logical change per turn** when possible; cap edits at 3–5 files per task unless the task explicitly requires more.
- **Read before edit**: open the real file and reference line numbers or symbols; do not assume signatures or structure.
- **Minimal edit**: prefer the smallest change that fixes the issue. Use targeted search_replace when possible; avoid rewriting whole files unless necessary.
- **After each significant step** (e.g. after adding a file, changing an API contract, or changing env/config), run the relevant check (e.g. `npm run lint`, `npm run test`, or the project’s build) and **show the output**; do not claim success without evidence.
- **In Agent/Auto, never say "I would run X" or "you can run X"** — run the command and paste the output. No exceptions.
- **Before declaring any task done**, run the mandatory commands from `02-task-completion.mdc` (test, lint, build) and **paste their output** in the delivery summary.

## Evidence Required

- **Never claim** “tests pass”, “build succeeds”, or “it works” without showing command output or a concrete file excerpt.
- When suggesting a fix: include the minimal code change, the exact command to validate it, and the expected outcome (and edge cases if relevant).
- If something is unclear (missing file, ambiguous requirement), say so and ask for details (e.g. @file) instead of guessing.

## When in Doubt

- **Stop and verify**: read the code, run the command, then answer.
- **Smaller steps**: split the task, do one step, show evidence, then continue.
- **Explicit trade-offs**: if there are multiple valid approaches, state them briefly and say which one you chose and why.
- **One question at a time**: if several things are unclear, ask the single most blocking question first; continue after the answer instead of listing many questions at once.
- **Stop after 3 failed attempts**: if the same fix or approach fails three times, stop. Summarize: what was tried, what failed, what might be wrong. Ask the user or suggest a different approach (e.g. different strategy, or human review). Do not keep guessing.

## Output Style (Helps Simpler Models Stay On Track)

- Use **short sentences** and **bullets** for summaries and checklists.
- Prefer **concrete** over abstract: file paths, command names, line references.
- When summarizing changes: list **Files** → **What changed** → **How to verify** (command + expected result).
- Avoid long prose when a list or table would do.

## Product Tip

In Cursor, **Settings → Models** lets you choose the default model for Chat, Composer, and Agent. If Auto uses a lighter model and quality drops, consider setting the Agent (or Composer) default to a stronger model (e.g. Claude Opus) for complex or multi-file tasks; use a faster model only for small, clear edits.
